"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[174],{9174:function(e,l,a){a.r(l),a.d(l,{default:function(){return p}});var t=a(3396),i=a(4870),o=a(4901),d=a(7178),s=a(2655),r=a(2748);const u={class:"dialog-footer"},n={name:"EditDialog"};var m=Object.assign(n,{props:{editDialogVisible:{type:Boolean,required:!0,default:!1},id:{type:Number,required:!0,default:-1},title:{type:String,required:!0,default:""}},emits:["update:editDialogVisible","handleSubmit"],setup(e,{emit:l}){const a=e,n=(0,t.Fl)({get(){return a.editDialogVisible},set(e){l("update:editDialogVisible",e)}}),m=(0,i.iH)({id:-1,name:"",idNo:"",sex:!1,tel:"",disabled:!1,note:""}),c=async(e,l,a)=>{let t;if("idNo"==e.field){let e=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;e.test(l)?t="/api/sys/persons/checkPerson?id="+m.value.id+"&idNo="+l:a(new Error("请输入正确的身份证号"))}else if("tel"==e.field){let e=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;e.test(l)?t="/api/sys/persons/checkPerson?id="+m.value.id+"&tel="+l:a(new Error("请输入正确的手机号"))}if(t){let e=await o.ZP.post(t);1==e.data.code?a(new Error(e.data.msg)):a()}},p=(0,i.qj)({name:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:2,max:16,message:"请输入正确的姓名",trigger:"change"},{min:2,max:16,message:"请输入正确的姓名",trigger:"blur"}],idNo:[{required:!0,message:"身份证号不能为空",trigger:"blur"},{validator:c,trigger:"change"},{validator:c,trigger:"blur"}],tel:[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:c,trigger:"change"},{validator:c,trigger:"blur"}],disabled:[{required:!0,message:"状态不能为空",trigger:"blur"}],note:[{required:!1,max:192,message:"备注信息不可超过192个字符",trigger:"blur"}]}),g=(0,i.iH)(null),v=async e=>{if(-1==e)m.value={id:-1,name:"",idNo:"",sex:!1,tel:"",disabled:!1,note:""},console.log("清空表单...");else{let l=await o.ZP.get("/api/sys/persons/"+e);if(console.log(l.data),20010==l.data.code){let e=l.data.person;m.value=e}else(0,d.z8)({message:l.data.msg,type:"error"});console.log("从后台填充...")}},f=e=>{s.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},w=()=>{n.value=!1},b=()=>{g.value.validate((async e=>{if(e){let e,a;-1==m.value.id?(console.log("提交新增..."),e="/api/sys/persons",a=await o.ZP.post(e,m.value),console.log("新增身份 res.data= ",a.data)):(console.log("提交修改..."),e="/api/sys/persons",a=await o.ZP.put(e,m.value),console.log("修改身份 res.data= ",a.data)),20020==a.data.code||20030==a.data.code?((0,d.z8)({message:a.data.msg,type:"success"}),l("handleSubmit"),w()):(0,d.z8)({message:a.data.msg,type:"error"})}}))};return(0,t.YP)(n,(e=>{1==e&&v(a.id)})),(l,a)=>{const o=(0,t.up)("el-input"),d=(0,t.up)("el-form-item"),s=(0,t.up)("el-switch"),c=(0,t.up)("el-form"),h=(0,t.up)("el-button"),y=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.j4)(y,{modelValue:(0,i.SU)(n),"onUpdate:modelValue":a[7]||(a[7]=e=>(0,i.dq)(n)?n.value=e:null),title:e.title,"before-close":f,width:"600px",draggable:""},{footer:(0,t.w5)((()=>[(0,t._)("span",u,[(0,t.Wm)(h,{onClick:a[6]||(a[6]=l=>v(e.id))},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1}),(0,t.Wm)(h,{onClick:w},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(h,{type:"primary",onClick:b},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(c,{ref_key:"editFormRef",ref:g,model:m.value,rules:p,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"姓名",prop:"name",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{modelValue:m.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"电话",prop:"tel",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{modelValue:m.value.tel,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value.tel=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"身份证号",prop:"idNo",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{modelValue:m.value.idNo,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value.idNo=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"性别",prop:"sex",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:m.value.sex,"onUpdate:modelValue":a[3]||(a[3]=e=>m.value.sex=e),style:{"--el-switch-on-color":"#f89898","--el-switch-off-color":"#409EFF"},"active-icon":(0,i.SU)(r.Female),"inactive-icon":(0,i.SU)(r.Male),"active-value":!0,"inactive-value":!1,width:"50px"},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,t.Wm)(d,{label:"状态",prop:"disabled",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:m.value.disabled,"onUpdate:modelValue":a[4]||(a[4]=e=>m.value.disabled=e),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"启用","inactive-text":"禁用","active-value":!1,"inactive-value":!0,width:"50px"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,{label:"备注",prop:"note",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{modelValue:m.value.note,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value.note=e),type:"textarea",rows:5},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}});const c=m;var p=c}}]);
//# sourceMappingURL=174.b19af9d1.js.map
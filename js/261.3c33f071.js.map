{"version":3,"file":"js/261.3c33f071.js","mappings":"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","sources":["webpack://hosp/./src/components/Menu.vue","webpack://hosp/./src/components/Menu.vue?ef75","webpack://hosp/./src/views/clinic/appointment/index.vue","webpack://hosp/./src/views/clinic/appointment/index.vue?46e1"],"sourcesContent":["<template>\r\n  <el-scrollbar>\r\n    <el-menu>\r\n\r\n      <template v-for=\"menu in menuData\" :key=\"menu.path+menu.name\">\r\n        <!--菜单项的index值，以及v-for的key值，现已暂时改为path值与name值的合体，因为path值可能会重复-->\r\n        <el-sub-menu v-if=\"menu.children!=undefined&&menu.children.length>0\" :index=\"menu.path+menu.name\">\r\n          <template #title>\r\n            <el-icon><component v-if=\"menu.icon!=''\" :is=\"menu.icon\"/></el-icon>\r\n            {{ menu.name }}\r\n          </template>\r\n          <template v-for=\"menuItem in menu.children\" :key=\"menuItem.path+menuItem.name\">\r\n            <el-menu-item :index=\"menuItem.path+menuItem.name\" @click=\"$emit('selectMenu', menu, menuItem)\">\r\n              <template #title>\r\n                <el-icon><component v-if=\"menuItem.icon!=''\" :is=\"menuItem.icon\"/></el-icon>\r\n                {{ menuItem.name }}\r\n              </template>\r\n            </el-menu-item>\r\n          </template>\r\n        </el-sub-menu>\r\n        <el-menu-item v-else :index=\"menu.path+menu.name\" @click=\"$emit('selectMenu', menu)\">\r\n          <template #title>\r\n            <el-icon><component v-if=\"menu.icon!=''\" :is=\"menu.icon\"/></el-icon>\r\n            {{ menu.name }}\r\n          </template>\r\n        </el-menu-item>\r\n      </template>\r\n\r\n    </el-menu>\r\n  </el-scrollbar>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Menu\",\r\n  props: ['menuData'],\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./Menu.vue?vue&type=template&id=83f96748\"\nimport script from \"./Menu.vue?vue&type=script&lang=js\"\nexport * from \"./Menu.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\DYZQ2\\\\Desktop\\\\redo\\\\hosp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <el-container>\r\n    <!--操作台-->\r\n    <el-header class=\"operatingFloor\">\r\n      <el-date-picker\r\n          v-model=\"dateRange\"\r\n          type=\"daterange\"\r\n          unlink-panels\r\n          range-separator=\"到\"\r\n          start-placeholder=\"开始日期\"\r\n          end-placeholder=\"结束日期\"\r\n          :shortcuts=\"shortcuts\"\r\n          size=\"default\"\r\n          @change=\"handleDateChange\"\r\n          style=\"float: left;\"\r\n      />\r\n      <el-select v-model=\"queryForm.status\" placeholder=\"请选择订单类型\" style=\"float: left;margin-left: 12px;\">\r\n        <el-option label=\"待就诊\" :value=\"0\"/>\r\n        <el-option label=\"已就诊\" :value=\"1\"/>\r\n        <el-option label=\"已取消\" :value=\"2\"/>\r\n        <el-option label=\"已过期\" :value=\"3\"/>\r\n        <el-option label=\"全部\" value=\"\"/>\r\n      </el-select>\r\n    </el-header>\r\n    <el-container>\r\n      <el-aside width=\"250px\">\r\n        <Menu :menu-data=\"menuData\" @select-menu=\"selectMenu\"/>\r\n      </el-aside>\r\n      <el-container>\r\n        <el-header style=\"height: 100px; padding: 8px 10px;\">\r\n          <el-descriptions\r\n              :column=\"4\"\r\n              size=\"default\"\r\n              border\r\n          >\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <User/>\r\n                  </el-icon>\r\n                  姓名\r\n                </div>\r\n              </template>\r\n              {{ editForm.patientInfo.name }}\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <QuestionFilled/>\r\n                  </el-icon>\r\n                  性别\r\n                </div>\r\n              </template>\r\n              {{ editForm.patientInfo.sex == 0 ? '男' : editForm.patientInfo.sex == 1 ? '女' : '' }}\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <InfoFilled/>\r\n                  </el-icon>\r\n                  身份证号\r\n                </div>\r\n              </template>\r\n              {{ editForm.patientInfo.idNo }}\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <Iphone/>\r\n                  </el-icon>\r\n                  手机号\r\n                </div>\r\n              </template>\r\n              {{ editForm.patientInfo.tel }}\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <Clock/>\r\n                  </el-icon>\r\n                  预约时段\r\n                </div>\r\n              </template>\r\n              {{ editForm.scheduleInfo.date }}\r\n              {{ editForm.scheduleInfo.time == 0 ? '上午' : editForm.scheduleInfo.time == 1 ? '下午' : '' }}\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <QuestionFilled/>\r\n                  </el-icon>\r\n                  订单状态\r\n                </div>\r\n              </template>\r\n              <span v-if=\"editForm.status==0\" style=\"color: #E6A23C;\">待就诊</span>\r\n              <span v-else-if=\"editForm.status==1\" style=\"color: #67C23A;\">已就诊</span>\r\n              <span v-else-if=\"editForm.status==2\" style=\"color: #F56C6C;\">已取消</span>\r\n              <span v-else-if=\"editForm.status==3\" style=\"color: #909399;\">已过期</span>\r\n            </el-descriptions-item>\r\n            <el-descriptions-item>\r\n              <template #label>\r\n                <div class=\"cell-item\">\r\n                  <el-icon>\r\n                    <EditPen/>\r\n                  </el-icon>\r\n                  最后提交时间\r\n                </div>\r\n              </template>\r\n              {{ editForm.updateTime ? editForm.updateTime : editForm.createTime }}\r\n            </el-descriptions-item>\r\n          </el-descriptions>\r\n        </el-header>\r\n        <el-main style=\"padding: 5px; background: aliceblue;\" id=\"mainView\">\r\n          <el-scrollbar>\r\n            <el-form\r\n                ref=\"editFormRef\"\r\n                :model=\"editForm\"\r\n                :rules=\"editFormRules\"\r\n                inline\r\n                label-width=\"80px\"\r\n                label-position=\"right\"\r\n                status-icon>\r\n              <el-form-item label=\"诊断结果\" prop=\"prescription\" style=\"width: 100%;\">\r\n                <el-input v-model=\"editForm.prescription\" type=\"textarea\" :rows=\"12\"/>\r\n              </el-form-item>\r\n              <el-form-item label=\" \" prop=\"\" style=\"width: 100%;\">\r\n                <el-popconfirm title=\"您确定要暂时跳过该订单吗？\" @confirm=\"handleSkip(editForm.id)\"\r\n                               v-if=\"hasAnyAuthority('clinic:appointment:edit')\">\r\n                  <template #reference>\r\n                    <el-button style=\"width: 25%;\" :disabled=\"editForm.isSkipped||editForm.status!=0\">跳过此单</el-button>\r\n                  </template>\r\n                </el-popconfirm>\r\n                <el-popconfirm title=\"您确定要关闭该订单吗？\" @confirm=\"handleDelete(editForm.id)\"\r\n                               v-if=\"hasAnyAuthority('clinic:appointment:edit')\">\r\n                  <template #reference>\r\n                    <el-button type=\"danger\" style=\"width: 20%;\" :disabled=\"editForm.status!=0\">关闭订单</el-button>\r\n                  </template>\r\n                </el-popconfirm>\r\n                <div class=\"flex-grow\"/>\r\n                <el-button type=\"primary\" style=\"width: 50%;\" @click=\"handleConfirm\" :disabled=\"editForm.status!=0\">提交诊断</el-button>\r\n              </el-form-item>\r\n              <el-form-item label=\"用户评价\" prop=\"remark\" style=\"width: 100%;\">\r\n                <el-input v-model=\"editForm.remark\" type=\"textarea\" :rows=\"10\" disabled/>\r\n              </el-form-item>\r\n            </el-form>\r\n          </el-scrollbar>\r\n        </el-main>\r\n      </el-container>\r\n    </el-container>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport {reactive, ref, watch} from 'vue'\r\nimport store from '@/store';\r\nimport {User, Clock, QuestionFilled, EditPen, InfoFilled, Iphone} from '@element-plus/icons-vue'\r\nimport AxiosUtil from \"@/utils/AxiosUtil\";\r\nimport {ElMessage} from \"element-plus\";\r\nimport Menu from \"@/components/Menu\";\r\nimport qs from \"qs\";\r\n\r\n/*====以下为一些数据的定义====*/\r\n\r\n// 定义本地用户信息\r\nconst userInfo = ref(store.getters.GET_USERINFO);\r\n\r\n// 定义表单的查询条件\r\nconst queryForm = reactive({\r\n  doctorId: userInfo.value.personId,\r\n  status: 0,\r\n  startDate: null,\r\n  endDate: null,\r\n});\r\n\r\n// 定义菜单数据（预约列表）\r\nlet menuData = ref([]);\r\n\r\n// 定义日期选择器的值\r\nconst dateRange = ref([]);\r\n\r\n// 定义编辑的订单id\r\nconst editId = ref(-1);\r\n\r\n// 定义表单数据\r\nconst editForm = ref({\r\n  id: -1,\r\n  createTime: '',\r\n  sequence: '',\r\n  status: 4,\r\n  prescription: null,\r\n  remark: null,\r\n  patientInfo: {\r\n    id: -1,\r\n    name: '',\r\n    idNo: '',\r\n    sex: null,\r\n    tel: '',\r\n  },\r\n  departmentInfo: {\r\n    id: -1,\r\n    name: '',\r\n  },\r\n  roomInfo: {\r\n    id: -1,\r\n    roomNo: '',\r\n    note: '',\r\n  },\r\n  scheduleInfo: {\r\n    id: -1,\r\n    date: '',\r\n    time: -1\r\n  }\r\n});\r\n\r\n// 定义日期选择器的快捷选项\r\nconst shortcuts = [\r\n  {\r\n    text: '一周内',\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n      return [start, end];\r\n    },\r\n  },\r\n  {\r\n    text: '一个月内',\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n      return [start, end];\r\n    },\r\n  },\r\n  {\r\n    text: '三个月内',\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n      return [start, end];\r\n    },\r\n  },\r\n];\r\n\r\n// 定义表单验证规则\r\nconst editFormRules = reactive({\r\n  prescription: [\r\n    {required: true, message: '诊断结果不能为空', trigger: 'blur'},\r\n    {max: 500, message: '诊断结果不可超过500个字符', trigger: 'blur'},\r\n  ],\r\n})\r\n\r\n// 定义表单引用\r\nconst editFormRef = ref(null);\r\n\r\n\r\n/*====以下为各按钮的点击事件====*/\r\n\r\n// 处理选择日期的变化\r\nconst handleDateChange = (dateRange) => {\r\n  console.log(dateRange);\r\n  if (dateRange) {\r\n    queryForm.startDate = dateToStr(dateRange[0]);\r\n    queryForm.endDate = dateToStr(dateRange[1]);\r\n  } else {\r\n    queryForm.startDate = null;\r\n    queryForm.endDate = null;\r\n  }\r\n}\r\n\r\n// 处理切换就诊人\r\nconst selectMenu = (menu) => {\r\n  editId.value = menu.path;\r\n  console.log(menu.path);\r\n  fetchData();\r\n}\r\n\r\n// 处理删除(关闭订单)\r\nconst handleDelete = async (id) => {\r\n  console.log('关闭订单...', id);\r\n  let url = '/api/clinic/appointments/' + id;\r\n  console.log('url=', url);\r\n  let res = await AxiosUtil.del(url);\r\n  console.log('res=', res);\r\n  if (res.data.code == 20040) {\r\n    ElMessage({\r\n      message: res.data.msg,\r\n      type: 'success',\r\n    });\r\n    await fetchData();\r\n  } else {\r\n    ElMessage({\r\n      message: res.data.msg,\r\n      type: 'error',\r\n    });\r\n  }\r\n}\r\n\r\n// 处理删除(跳过订单)\r\nconst handleSkip = async (id) => {\r\n  console.log('跳过订单...', id);\r\n  let url = '/api/clinic/appointments/skipAppointment/' + id;\r\n  console.log('url=', url);\r\n  let res = await AxiosUtil.del(url);\r\n  console.log('res=', res);\r\n  if (res.data.code == 20040) {\r\n    ElMessage({\r\n      message: res.data.msg,\r\n      type: 'success',\r\n    });\r\n    await fetchData();\r\n  } else {\r\n    ElMessage({\r\n      message: res.data.msg,\r\n      type: 'error',\r\n    });\r\n  }\r\n}\r\n\r\n// 定义提交按钮事件\r\nconst handleConfirm = () => {\r\n  // 表单验证\r\n  editFormRef.value.validate(async valid => {\r\n    if (valid) {\r\n      // 表单验证通过\r\n      let url, res;\r\n      console.log('提交诊断结果...');\r\n      url = '/api/clinic/appointments';\r\n      res = await AxiosUtil.put(url, editForm.value);\r\n      console.log(\"修改订单 res.data= \", res.data);\r\n      if (res.data.code == 20020 || res.data.code == 20030) {\r\n        ElMessage({\r\n          message: res.data.msg,\r\n          type: 'success',\r\n        });\r\n        await fetchData();\r\n      } else {\r\n        ElMessage({\r\n          message: res.data.msg,\r\n          type: 'error',\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n\r\n/*====以下为一些监听以及其他函数====*/\r\n\r\n// 转换日期为字符串\r\nconst dateToStr = (dateDate) => {\r\n  let year = dateDate.getFullYear();\r\n  let month = (dateDate.getMonth() + 1);\r\n  let date = dateDate.getDate();\r\n  let dateStr = year + '-' + (month < 10 ? '0' + month : month) + '-' + (date < 10 ? '0' + date : date);\r\n  console.log('dateToStr dateDate=', dateDate, ', dateStr=', dateStr);\r\n  return dateStr;\r\n}\r\n\r\n// 转换字符串为日期\r\nconst strToDate = (dateStr) => {\r\n  let year = parseInt(dateStr.substring(0, 4));\r\n  let month = parseInt(dateStr.substring(5, 7));\r\n  let date = parseInt(dateStr.substring(8, 10));\r\n  // console.log(year, month, date);\r\n  let dateDate = new Date(year, month - 1, date, 0, 0, 0, 0);\r\n  console.log('strToDate dateStr=', dateStr, ', dateDate=', dateDate);\r\n  return dateDate;\r\n}\r\n\r\n// 从后台获取数据\r\nconst fetchData = async () => {\r\n  // 从后台获取数据\r\n  let url = '/api/clinic/appointments?' + qs.stringify(queryForm);\r\n  console.log(url);\r\n  let res = await AxiosUtil.get(url);\r\n  console.log(\"更新预约信息 res= \", res);\r\n  if (res.data.code == 20010) {\r\n    // 更新订单列表\r\n    let menus = [];\r\n    res.data.appointmentList.forEach(item => {\r\n      let menu = {\r\n        name: item.sequence + ' ' + item.patientInfo.name + ' ... ' + (item.status == 0 ? '待就诊' : item.status == 1 ? '已就诊' : item.status == 2 ? '已取消' : item.status == 3 ? '已过期' : '错误') + (item.isSkipped ? '（暂时跳过）' : ''),\r\n        path: item.id,\r\n      };\r\n      menus.push(menu);\r\n    })\r\n    menuData.value = menus;\r\n  } else {\r\n    ElMessage({\r\n      message: res.data.msg,\r\n      type: 'error',\r\n    });\r\n  }\r\n  // 更新编辑的预约订单信息\r\n  if (editId.value != -1) {\r\n    let url2 = '/api/clinic/appointments/' + editId.value;\r\n    console.log(url2);\r\n    let res2 = await AxiosUtil.get(url2);\r\n    console.log(\"更新预约信息 res= \", res2);\r\n    if (res2.data.code == 20010) {\r\n      // 更新正在编辑的订单\r\n      editForm.value = res2.data.appointment;\r\n    } else {\r\n      editForm.value = {\r\n        id: -1,\r\n        createTime: '',\r\n        sequence: '',\r\n        status: 4,\r\n        prescription: null,\r\n        remark: null,\r\n        patientInfo: {\r\n          id: -1,\r\n          name: '',\r\n          idNo: '',\r\n          sex: null,\r\n          tel: '',\r\n        },\r\n        departmentInfo: {\r\n          id: -1,\r\n          name: '',\r\n        },\r\n        roomInfo: {\r\n          id: -1,\r\n          roomNo: '',\r\n          note: '',\r\n        },\r\n        scheduleInfo: {\r\n          id: -1,\r\n          date: '',\r\n          time: -1\r\n        }\r\n      };\r\n      ElMessage({\r\n        message: res2.data.msg,\r\n        type: 'error',\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfetchData();\r\n\r\n// 当表单的查询查询条件发生变化时，重新拉取数据\r\nwatch(queryForm, async (newForm, oldForm) => {\r\n  console.log(Date.now() + ' 重新拉取数据...');\r\n  console.log(queryForm);\r\n  await fetchData();\r\n});\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: \"index\"\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n/*操作台*/\r\n.operatingFloor {\r\n  //display: flex;\r\n  //align-items: center; /*align-items 属性可以使元素在交叉轴方向对齐*/\r\n  //justify-content: flex-start; /*justify-content属性用来使元素在主轴方向上对齐*/\r\n  height: 64px;\r\n  padding: 8px 10px;\r\n}\r\n\r\n.operatingFloor .el-menu--horizontal > .el-menu-item {\r\n  width: 50%;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.cell-item {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.flex-grow {\r\n  flex-grow: 1;\r\n}\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=450309e4&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\DYZQ2\\\\Desktop\\\\redo\\\\hosp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-450309e4\"]])\n\nexport default __exports__"],"names":["_createBlock","_component_el_scrollbar","_createVNode","_component_el_menu","_createElementBlock","_Fragment","_renderList","$props","menu","path","name","undefined","children","length","_component_el_sub_menu","index","title","_component_el_icon","icon","_resolveDynamicComponent","key","_toDisplayString","menuItem","_component_el_menu_item","onClick","_ctx","props","__exports__","render","userInfo","ref","store","queryForm","reactive","doctorId","value","personId","status","startDate","endDate","menuData","dateRange","editId","editForm","id","createTime","sequence","prescription","remark","patientInfo","idNo","sex","tel","departmentInfo","roomInfo","roomNo","note","scheduleInfo","date","time","shortcuts","text","end","Date","start","setTime","getTime","editFormRules","required","message","trigger","max","editFormRef","handleDateChange","console","log","dateToStr","selectMenu","fetchData","handleDelete","async","url","res","AxiosUtil","data","code","ElMessage","msg","type","handleSkip","handleConfirm","validate","valid","dateDate","year","getFullYear","month","getMonth","getDate","dateStr","qs","menus","appointmentList","forEach","item","isSkipped","push","url2","res2","appointment","watch","newForm","oldForm","now"],"sourceRoot":""}
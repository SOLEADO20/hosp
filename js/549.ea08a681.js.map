{"version":3,"file":"js/549.ea08a681.js","mappings":"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","sources":["webpack://hosp/./src/views/sys/role/EditDialog.vue","webpack://hosp/./src/views/sys/role/EditDialog.vue?2132"],"sourcesContent":["<template>\r\n  <el-dialog v-model=\"editDialogVisible\" :title=\"title\" :before-close=\"handleClose\" width=\"600px\" draggable>\r\n    <el-form\r\n        ref=\"editFormRef\"\r\n        :model=\"editForm\"\r\n        :rules=\"editFormRules\"\r\n        inline\r\n        label-width=\"80px\"\r\n        label-position=\"right\"\r\n        status-icon>\r\n      <el-form-item label=\"角色名称\" prop=\"name\" style=\"width: 48%;\">\r\n        <el-input v-model=\"editForm.name\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"角色代号\" prop=\"code\" style=\"width: 40%;\">\r\n        <el-input v-model=\"editForm.code\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"状态\" prop=\"disabled\" style=\"width: 40%;\">\r\n        <el-switch\r\n            v-model=\"editForm.disabled\"\r\n            style=\"--el-switch-on-color: #13ce66; --el-switch-off-color: #ff4949\"\r\n            active-text=\"启用\"\r\n            inactive-text=\"禁用\"\r\n            :active-value=\"false\"\r\n            :inactive-value=\"true\"\r\n            width=\"50px\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"备注\" prop=\"note\" style=\"width: 100%;\">\r\n        <el-input v-model=\"editForm.note\" type=\"textarea\" :rows=\"5\"/>\r\n      </el-form-item>\r\n    </el-form>\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"handleReset(id)\">重置</el-button>\r\n        <el-button @click=\"handleCancel\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"handleConfirm\">确定</el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport {defineProps, defineEmits, computed, ref, watch, reactive} from 'vue';\r\nimport AxiosUtil from \"@/utils/AxiosUtil\";\r\nimport {ElMessageBox, ElMessage} from \"element-plus\";\r\n\r\n// 定义传入该子组件的参数\r\nconst props = defineProps({\r\n  editDialogVisible: {\r\n    type: Boolean,\r\n    required: true,\r\n    default: false\r\n  },\r\n  id: {\r\n    type: Number,\r\n    required: true,\r\n    default: -1\r\n  },\r\n  title: {\r\n    type: String,\r\n    required: true,\r\n    default: ''\r\n  }\r\n});\r\n\r\n// 定义组件（自定义）事件\r\nconst emit = defineEmits(['update:editDialogVisible', 'handleSubmit']);\r\n\r\n// 定义“编辑”对话框的显示状态\r\nconst editDialogVisible = computed({\r\n  // 只读！读取时从父组件获取，更新时更新父组件\r\n  get() {\r\n    return props.editDialogVisible;\r\n  },\r\n  set(newValue) {\r\n    emit('update:editDialogVisible', newValue);\r\n  }\r\n});\r\n\r\n// 定义表单数据\r\nconst editForm = ref({\r\n  id: -1,\r\n  name: '',\r\n  code: '',\r\n  disabled: false,\r\n  note: '',\r\n});\r\n\r\nconst validateRole = async (rule, value, callback) => {\r\n  // console.log(rule.field)\r\n  // console.log(value)\r\n\r\n  let url;\r\n  // 基础格式验证通过后，才给 url 赋值。\r\n  if (rule.field == 'name') {\r\n    if (value && value.length > 16) {\r\n      callback(new Error('角色名称长度不可超过16位'));\r\n    } else {\r\n      url = '/api/sys/roles/checkRole?id=' + editForm.value.id + '&name=' + value;\r\n    }\r\n  } else if (rule.field == 'code') {\r\n    if (value && value.length > 16) {\r\n      callback(new Error('角色代号长度不可超过16位'));\r\n    } else {\r\n      url = '/api/sys/roles/checkRole?id=' + editForm.value.id + '&code=' + value;\r\n    }\r\n  }\r\n  // url 有值，才向后台发送验证请求。\r\n  // console.log(url);\r\n  if (url) {\r\n    // console.log('向后台发送请求');\r\n    let res = await AxiosUtil.post(url);\r\n    // console.log(res.data);\r\n    if (res.data.code == 1) {\r\n      callback(new Error(res.data.msg));\r\n    } else {\r\n      callback();\r\n    }\r\n  }\r\n}\r\n\r\n// 定义表单验证规则\r\nconst editFormRules = reactive({\r\n  name: [\r\n    {required: true, message: '角色名称不能为空', trigger: 'blur'},\r\n    {validator: validateRole, trigger: 'change'},\r\n    {validator: validateRole, trigger: 'blur'},\r\n  ],\r\n  code: [\r\n    {required: true, message: '角色代号不能为空', trigger: 'blur'},\r\n    {validator: validateRole, trigger: 'change'},\r\n    {validator: validateRole, trigger: 'blur'},\r\n  ],\r\n  disabled: [\r\n    {required: true, message: '状态不能为空', trigger: 'blur'},\r\n  ],\r\n  note: [\r\n    {required: false, max: 192, message: '备注信息不可超过192个字符', trigger: 'blur'},\r\n  ],\r\n})\r\n\r\n// 定义表单引用\r\nconst editFormRef = ref(null);\r\n\r\n// 表单重置事件\r\nconst handleReset = async (id) => {\r\n  if (id == -1) {\r\n    editForm.value = {\r\n      id: -1,\r\n      name: '',\r\n      code: '',\r\n      disabled: false,\r\n      note: '',\r\n    };\r\n    console.log('清空表单...');\r\n  } else {\r\n    let res = await AxiosUtil.get('/api/sys/roles/' + id);\r\n    console.log(res.data);\r\n    if (res.data.code == 20010) {\r\n      let role = res.data.role;\r\n      // 更新表格数据\r\n      editForm.value = role;\r\n    } else {\r\n      ElMessage({\r\n        message: res.data.msg,\r\n        type: 'error',\r\n      });\r\n    }\r\n    console.log('从后台填充...');\r\n  }\r\n}\r\n\r\n// 定义关闭对话框前的确认操作\r\nconst handleClose = (done) => {\r\n  ElMessageBox.confirm('确认在未保存的情况下关闭对话框？')\r\n      .then(() => {\r\n        done()\r\n      })\r\n      .catch(() => {\r\n        // catch error\r\n      })\r\n}\r\n\r\n// 定义对话框关闭事件\r\nconst handleCancel = () => {\r\n  editDialogVisible.value = false;\r\n}\r\n\r\n// 定义确认按钮事件\r\nconst handleConfirm = () => {\r\n  // 表单验证\r\n  editFormRef.value.validate(async valid => {\r\n    if (valid) {\r\n      // 表单验证通过\r\n      let url, res;\r\n      if (editForm.value.id == -1) {\r\n        console.log('提交新增...');\r\n        url = '/api/sys/roles';\r\n        res = await AxiosUtil.post(url, editForm.value);\r\n        console.log(\"新增角色 res.data= \", res.data);\r\n      } else {\r\n        console.log('提交修改...');\r\n        url = '/api/sys/roles';\r\n        res = await AxiosUtil.put(url, editForm.value);\r\n        console.log(\"修改角色 res.data= \", res.data);\r\n      }\r\n      if (res.data.code == 20020 || res.data.code == 20030) {\r\n        ElMessage({\r\n          message: res.data.msg,\r\n          type: 'success',\r\n        });\r\n        emit('handleSubmit'); // 触发自定义事件，使父组件刷新数据\r\n        handleCancel(); // 关闭对话框\r\n      } else {\r\n        ElMessage({\r\n          message: res.data.msg,\r\n          type: 'error',\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n// 当对话框重新显示时重置表单\r\nwatch(editDialogVisible, (newValue) => {\r\n  if (newValue == true) {\r\n    handleReset(props.id);\r\n  }\r\n})\r\n\r\n</script>\r\n\r\n\r\n<script>\r\nexport default {\r\n  name: \"EditDialog\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import script from \"./EditDialog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EditDialog.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["name","editDialogVisible","computed","get","props","set","newValue","emit","editForm","ref","id","code","disabled","note","validateRole","async","rule","value","callback","url","field","length","Error","res","AxiosUtil","data","msg","editFormRules","reactive","required","message","trigger","validator","max","editFormRef","handleReset","console","log","role","ElMessage","type","handleClose","done","ElMessageBox","then","catch","handleCancel","handleConfirm","validate","valid","watch","__exports__"],"sourceRoot":""}
"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[675],{8675:function(e,l,t){t.r(l),t.d(l,{default:function(){return f}});var a=t(3396),i=t(4870),o=t(4901),n=t(2655),r=t(7178),u=t(2748);const d={class:"dialog-footer"},s={name:"EditDialog"};var p=Object.assign(s,{props:{editDialogVisible:{type:Boolean,required:!0,default:!1},userId:{type:Number,required:!0,default:-1}},emits:["update:editDialogVisible","handleSubmit"],setup(e,{emit:l}){const t=e,s=(0,a.Fl)({get(){return t.editDialogVisible},set(e){l("update:editDialogVisible",e)}}),p=(0,i.iH)({id:-1,userId:t.userId,patientId:-1,relation:"",note:"",patientInfo:{id:-1,name:"",idNo:"",sex:!1,tel:""}}),m=(0,i.qj)(["父亲","母亲","爷爷","奶奶","哥哥","弟弟","姐姐","妹妹"]),f=async(e,l,t)=>{if("patientInfo.idNo"==e.field){let e=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;e.test(l)?t():t(new Error("请输入正确的身份证号"))}else if("patientInfo.tel"==e.field){let e=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;e.test(l)?t():t(new Error("请输入正确的手机号"))}},g=(0,i.qj)({"patientInfo.name":[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:2,max:16,message:"请输入正确的姓名",trigger:"blur"}],"patientInfo.idNo":[{required:!0,message:"身份证号不能为空",trigger:"blur"},{validator:f,trigger:"change"},{validator:f,trigger:"blur"}],"patientInfo.tel":[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:f,trigger:"change"},{validator:f,trigger:"blur"}],"patientInfo.sex":[{required:!0,message:"性别不能为空",trigger:"blur"}],relation:[{required:!0,message:"关系不能为空",trigger:"blur"},{max:6,message:"关系信息不可超过6个字符 ",trigger:"blur"}],note:[{required:!1,max:192,message:"备注信息不可超过192个字符",trigger:"blur"}]}),c=(0,i.iH)(null),v=async()=>{p.value={id:-1,userId:t.userId,patientId:-1,relation:"",note:"",patientInfo:{id:-1,name:"",idNo:"",sex:!1,tel:""}},console.log("清空表单...")},w=e=>{n.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},b=()=>{s.value=!1},I=()=>{c.value.validate((async e=>{if(e){let e,t;-1==p.value.id&&(console.log("提交新增..."),e="/api/center/patients",t=await o.ZP.post(e,p.value),console.log("新增就诊人 res.data= ",t.data)),20020==t.data.code?((0,r.z8)({message:t.data.msg,type:"success"}),l("handleSubmit"),b()):(0,r.z8)({message:t.data.msg,type:"error"})}}))};return(0,a.YP)(s,(e=>{1==e&&v()})),(e,l)=>{const t=(0,a.up)("el-input"),o=(0,a.up)("el-form-item"),n=(0,a.up)("el-switch"),r=(0,a.up)("el-option"),f=(0,a.up)("el-select"),V=(0,a.up)("el-form"),h=(0,a.up)("el-button"),y=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(y,{modelValue:(0,i.SU)(s),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,i.dq)(s)?s.value=e:null),title:"就诊人添加","before-close":w,width:"600px",draggable:""},{footer:(0,a.w5)((()=>[(0,a._)("span",d,[(0,a.Wm)(h,{onClick:l[6]||(l[6]=e=>v())},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1}),(0,a.Wm)(h,{onClick:b},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1}),(0,a.Wm)(h,{type:"primary",onClick:I},{default:(0,a.w5)((()=>[(0,a.Uk)("确定")])),_:1})])])),default:(0,a.w5)((()=>[(0,a.Wm)(V,{ref_key:"editFormRef",ref:c,model:p.value,rules:g,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{label:"姓名",prop:"patientInfo.name",style:{width:"48%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{modelValue:p.value.patientInfo.name,"onUpdate:modelValue":l[0]||(l[0]=e=>p.value.patientInfo.name=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"电话",prop:"patientInfo.tel",style:{width:"40%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{modelValue:p.value.patientInfo.tel,"onUpdate:modelValue":l[1]||(l[1]=e=>p.value.patientInfo.tel=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"身份证号",prop:"patientInfo.idNo",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{modelValue:p.value.patientInfo.idNo,"onUpdate:modelValue":l[2]||(l[2]=e=>p.value.patientInfo.idNo=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"性别",prop:"patientInfo.sex",style:{width:"48%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:p.value.patientInfo.sex,"onUpdate:modelValue":l[3]||(l[3]=e=>p.value.patientInfo.sex=e),style:{"--el-switch-on-color":"#f89898","--el-switch-off-color":"#409EFF"},"active-icon":(0,i.SU)(u.Female),"inactive-icon":(0,i.SU)(u.Male),"active-value":!0,"inactive-value":!1,width:"50px"},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,a.Wm)(o,{label:"关系",prop:"relation",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:p.value.relation,"onUpdate:modelValue":l[4]||(l[4]=e=>p.value.relation=e),filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m,(e=>((0,a.wg)(),(0,a.j4)(r,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(o,{label:"备注",prop:"note",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{modelValue:p.value.note,"onUpdate:modelValue":l[5]||(l[5]=e=>p.value.note=e),type:"textarea",rows:5},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}});const m=p;var f=m}}]);
//# sourceMappingURL=675.f976a68b.js.map
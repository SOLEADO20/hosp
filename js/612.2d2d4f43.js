"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[612],{9612:function(e,a,t){t.r(a),t.d(a,{default:function(){return m}});t(7658);var l=t(3396),o=t(4870),d=t(4901),n=t(7178),r=t(2655);const u={class:"dialog-footer"},i={name:"EditDialog"};var s=Object.assign(i,{props:{changeDepartmentDialogVisible:{type:Boolean,required:!0,default:!1},doctorList:{type:Array,required:!0,default:()=>[]}},emits:["update:changeDepartmentDialogVisible","handleSubmit"],setup(e,{emit:a}){const t=e,i=(0,l.Fl)({get(){return t.changeDepartmentDialogVisible},set(e){a("update:changeDepartmentDialogVisible",e)}}),s=(0,o.iH)({id:[],departmentId:0}),p=(0,o.iH)([]),m=(0,o.qj)({departmentId:[{required:!0,message:"科室不能为空",trigger:"blur"}]}),c=(0,o.iH)(null),g=async e=>{let a=[];for(const o of t.doctorList)a.push(o.id);s.value={id:a,departmentId:0},console.log("清空表单...");let l=await d.ZP.get("/api/bsns/departments");if(console.log(l.data),20010==l.data.code){let e=[];l.data.departmentList.forEach((a=>{a.name="+ "+a.name,e.push(a),a.children.forEach((a=>{a.name="••• "+a.name,e.push(a)}))})),p.value=e}else(0,n.z8)({message:l.data.msg,type:"error"})},f=e=>{r.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},h=()=>{i.value=!1},b=()=>{c.value.validate((async e=>{if(e){let e,t;console.log("提交修改..."),e="/api/bsns/workers/updateDepartment/"+s.value.id.join(",")+"/"+s.value.departmentId,console.log("url=",e),t=await d.ZP.put(e,s.value),console.log("修改岗位科室 res.data= ",t.data),20020==t.data.code||20030==t.data.code?((0,n.z8)({message:t.data.msg,type:"success"}),a("handleSubmit"),h()):(0,n.z8)({message:t.data.msg,type:"error"})}}))};return(0,l.YP)(i,(e=>{1==e&&g()})),(e,a)=>{const t=(0,l.up)("el-option"),d=(0,l.up)("el-select"),n=(0,l.up)("el-form-item"),r=(0,l.up)("el-form"),v=(0,l.up)("el-button"),w=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(w,{modelValue:(0,o.SU)(i),"onUpdate:modelValue":a[1]||(a[1]=e=>(0,o.dq)(i)?i.value=e:null),title:"批量变更科室","before-close":f,width:"600px",draggable:""},{footer:(0,l.w5)((()=>[(0,l._)("span",u,[(0,l.Wm)(v,{onClick:g},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(v,{onClick:h},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(v,{type:"primary",onClick:b},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(r,{ref_key:"editFormRef",ref:c,model:s.value,rules:m,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{label:"科室",prop:"departmentId",style:{width:"48%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:s.value.departmentId,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.departmentId=e),placeholder:"请选择科室"},{default:(0,l.w5)((()=>[(0,l.Wm)(t,{label:"顶级科室",value:0}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(p.value,(e=>((0,l.wg)(),(0,l.j4)(t,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}});const p=s;var m=p}}]);
//# sourceMappingURL=612.2d2d4f43.js.map
"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[847],{9847:function(e,l,a){a.r(l),a.d(l,{default:function(){return p}});var r=a(3396),o=a(4870),s=a(4901),t=a(2748),i=a(2655),d=a(7178);const n={class:"dialog-footer"},u={name:"RegisterDialog"};var m=Object.assign(u,{props:{registerDialogVisible:{type:Boolean,required:!0,default:!1}},emits:["update:registerDialogVisible","handleSubmit"],setup(e,{emit:l}){const a=e,u=(0,r.Fl)({get(){return a.registerDialogVisible},set(e){l("update:registerDialogVisible",e)}}),m=(0,o.iH)({id:-1,username:"",password:"",rePassword:"",disabled:!1,note:"",personInfo:{name:"",idNo:"",tel:void 0,sex:!1,disabled:!1}}),g=async(e,l,a)=>{let r;if("username"==e.field)l&&l.length>16?a(new Error("用户名长度不可超过16位")):r="/api/center/users/checkUser?id="+m.value.id+"&username="+l;else if("personInfo.idNo"==e.field){let e=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;e.test(l)?r="/api/center/users/checkUser?id="+m.value.id+"&idNo="+l:a(new Error("请输入正确的身份证号"))}else if("personInfo.tel"==e.field){let e=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;e.test(l)?r="/api/center/users/checkUser?id="+m.value.id+"&tel="+l:a(new Error("请输入正确的手机号"))}else"rePassword"==e.field&&(l!=m.value.password?a(new Error("两次密码输入不一致")):a());if(r){let e=await s.ZP.post(r);1==e.data.code?a(new Error(e.data.msg)):a()}},p=(0,o.qj)({username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{validator:g,trigger:"change"},{validator:g,trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:16,message:"密码长度不低于6位，不超过16位",trigger:"change"},{min:6,max:16,message:"密码长度不低于6位，不超过16位",trigger:"blur"}],rePassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:g,trigger:"change"},{validator:g,trigger:"blur"}],disabled:[{required:!0,message:"状态不能为空",trigger:"blur"}],"personInfo.name":[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:2,max:16,message:"请输入正确的姓名",trigger:"change"},{min:2,max:16,message:"请输入正确的姓名",trigger:"blur"}],"personInfo.idNo":[{required:!0,message:"身份证号不能为空",trigger:"blur"},{validator:g,trigger:"change"},{validator:g,trigger:"blur"}],"personInfo.tel":[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:g,trigger:"change"},{validator:g,trigger:"blur"}],"personInfo.sex":[{required:!0,message:"请输入性别",trigger:"blur"}]}),c=(0,o.iH)(null),f=async()=>{m.value={id:-1,username:"",password:"",rePassword:"",disabled:!1,note:"",personInfo:{name:"",idNo:"",tel:void 0,sex:!1,disabled:!1}},console.log("清空表单...")},w=e=>{i.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},v=()=>{u.value=!1},b=()=>{c.value.validate((async e=>{if(e){let e,a;console.log("提交新增..."),e="/api/center/users/register",a=await s.ZP.post(e,m.value),console.log("新增用户 res.data= ",a.data),20020==a.data.code?((0,d.z8)({message:a.data.msg,type:"success"}),l("handleSubmit"),v()):(0,d.z8)({message:a.data.msg,type:"error"})}}))};return(0,r.YP)(u,(e=>{1==e&&f()})),(e,l)=>{const a=(0,r.up)("el-input"),s=(0,r.up)("el-form-item"),i=(0,r.up)("el-switch"),d=(0,r.up)("el-form"),g=(0,r.up)("el-button"),h=(0,r.up)("el-dialog");return(0,r.wg)(),(0,r.j4)(h,{modelValue:(0,o.SU)(u),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,o.dq)(u)?u.value=e:null),title:"用户注册","before-close":w,width:"600px",draggable:""},{footer:(0,r.w5)((()=>[(0,r._)("span",n,[(0,r.Wm)(g,{onClick:f},{default:(0,r.w5)((()=>[(0,r.Uk)("重置")])),_:1}),(0,r.Wm)(g,{onClick:v},{default:(0,r.w5)((()=>[(0,r.Uk)("取消")])),_:1}),(0,r.Wm)(g,{type:"primary",onClick:b},{default:(0,r.w5)((()=>[(0,r.Uk)("确定")])),_:1})])])),default:(0,r.w5)((()=>[(0,r.Wm)(d,{ref_key:"editFormRef",ref:c,model:m.value,rules:p,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{label:"用户名",prop:"username",style:{width:"48%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.username,"onUpdate:modelValue":l[0]||(l[0]=e=>m.value.username=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"姓名",prop:"personInfo.name",style:{width:"40%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.personInfo.name,"onUpdate:modelValue":l[1]||(l[1]=e=>m.value.personInfo.name=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"身份证号",prop:"personInfo.idNo",style:{width:"48%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.personInfo.idNo,"onUpdate:modelValue":l[2]||(l[2]=e=>m.value.personInfo.idNo=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"电话",prop:"personInfo.tel",style:{width:"40%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.personInfo.tel,"onUpdate:modelValue":l[3]||(l[3]=e=>m.value.personInfo.tel=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"性别",prop:"personInfo.sex",style:{width:"48%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:m.value.personInfo.sex,"onUpdate:modelValue":l[4]||(l[4]=e=>m.value.personInfo.sex=e),style:{"--el-switch-on-color":"#f89898","--el-switch-off-color":"#409EFF"},"active-icon":(0,o.SU)(t.Female),"inactive-icon":(0,o.SU)(t.Male),"active-value":!0,"inactive-value":!1,width:"50px"},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,r.Wm)(s,{label:"密码",prop:"password",style:{width:"100%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.password,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value.password=e),type:"password",rows:5},null,8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"确认密码",prop:"rePassword",style:{width:"100%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{modelValue:m.value.rePassword,"onUpdate:modelValue":l[6]||(l[6]=e=>m.value.rePassword=e),type:"password",rows:5},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}});const g=m;var p=g}}]);
//# sourceMappingURL=847.de64c890.js.map
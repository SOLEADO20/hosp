"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[31],{7031:function(e,a,l){l.r(a),l.d(a,{default:function(){return p}});var t=l(3396),d=l(4870),o=l(4901),i=l(7178),r=l(2655);const s={class:"dialog-footer"},u={name:"EditDialog"};var n=Object.assign(u,{props:{editDialogVisible:{type:Boolean,required:!0,default:!1},id:{type:Number,required:!0,default:-1},title:{type:String,required:!0,default:""}},emits:["update:editDialogVisible","handleSubmit"],setup(e,{emit:a}){const l=e,u=(0,t.Fl)({get(){return l.editDialogVisible},set(e){a("update:editDialogVisible",e)}}),n=(0,d.iH)({id:-1,parentId:0,name:"",disabled:!1,note:""}),m=(0,d.iH)([]),p=async(e,a,l)=>{let t;if("name"==e.field&&(a&&a.length>16?l(new Error("科室名称长度不可超过16位")):t="/api/bsns/departments/checkDepartment?id="+n.value.id+"&name="+a),t){let e=await o.ZP.post(t);1==e.data.code?l(new Error(e.data.msg)):l()}},g=(0,d.qj)({parentId:[{required:!0,message:"上级科室不能为空",trigger:"blur"}],name:[{required:!0,message:"科室名称不能为空",trigger:"blur"},{validator:p,trigger:"change"},{validator:p,trigger:"blur"}],disabled:[{required:!0,message:"状态不能为空",trigger:"blur"}],note:[{required:!1,max:300,message:"科室介绍不可超过300个字符",trigger:"blur"}]}),c=(0,d.iH)(null),b=async e=>{if(-1==e)n.value={id:-1,parentId:0,name:"",disabled:!1,note:""},console.log("清空表单...");else{let a=await o.ZP.get("/api/bsns/departments/"+e);if(console.log(a.data),20010==a.data.code){let e=a.data.department;n.value=e}else(0,i.z8)({message:a.data.msg,type:"error"});console.log("从后台填充...")}let a=await o.ZP.get("/api/bsns/departments");if(console.log(a.data),20010==a.data.code){let e=a.data.departmentList;m.value=e}else(0,i.z8)({message:a.data.msg,type:"error"})},f=e=>{r.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},w=()=>{u.value=!1},v=()=>{c.value.validate((async e=>{if(e){let e,l;-1==n.value.id?(console.log("提交新增..."),e="/api/bsns/departments",l=await o.ZP.post(e,n.value),console.log("新增科室 res.data= ",l.data)):(console.log("提交修改..."),e="/api/bsns/departments",l=await o.ZP.put(e,n.value),console.log("修改科室 res.data= ",l.data)),20020==l.data.code||20030==l.data.code?((0,i.z8)({message:l.data.msg,type:"success"}),a("handleSubmit"),w()):(0,i.z8)({message:l.data.msg,type:"error"})}}))};return(0,t.YP)(u,(e=>{1==e&&b(l.id)})),(a,l)=>{const o=(0,t.up)("el-option"),i=(0,t.up)("el-select"),r=(0,t.up)("el-form-item"),p=(0,t.up)("el-input"),h=(0,t.up)("el-form"),y=(0,t.up)("el-button"),V=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.j4)(V,{modelValue:(0,d.SU)(u),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.dq)(u)?u.value=e:null),title:e.title,"before-close":f,width:"600px",draggable:""},{footer:(0,t.w5)((()=>[(0,t._)("span",s,[(0,t.Wm)(y,{onClick:l[3]||(l[3]=a=>b(e.id))},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1}),(0,t.Wm)(y,{onClick:w},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(y,{type:"primary",onClick:v},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(h,{ref_key:"editFormRef",ref:c,model:n.value,rules:g,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"父节点",prop:"parentId",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:n.value.parentId,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value.parentId=e),placeholder:"请选择上级科室"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{label:"顶级科室",value:0}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(m.value,(e=>((0,t.wg)(),(0,t.j4)(o,{key:e.id,label:"+ "+e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"科室名称",prop:"name",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:n.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"科室介绍",prop:"note",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:n.value.note,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value.note=e),type:"textarea",rows:5},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}});const m=n;var p=m}}]);
//# sourceMappingURL=31.0d77dbfb.js.map
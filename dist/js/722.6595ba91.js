"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[722],{8722:function(e,a,t){t.r(a),t.d(a,{default:function(){return g}});t(7658);var l=t(3396),o=t(4870),s=t(4901),r=t(7178),n=t(2655);const u={class:"dialog-footer"},d={name:"GrantMenuDialog"};var i=Object.assign(d,{props:{grantMenuDialogVisible:{type:Boolean,required:!0,default:!1},id:{type:Number,required:!0,default:-1}},emits:["update:grantMenuDialogVisible","handleSubmit"],setup(e,{emit:a}){const t=e,d=(0,l.Fl)({get(){return t.grantMenuDialogVisible},set(e){a("update:grantMenuDialogVisible",e)}}),i=(0,o.iH)({id:-1}),c={label:"name",children:"children"},g=(0,o.iH)([]),m=(0,o.iH)(null),p=(e,a,t)=>{},f=async e=>{try{let a=await s.ZP.get("/api/sys/menus"),t=await s.ZP.get("/api/sys/roles/"+e);if(console.log(a.data),console.log(t.data),20010==a.data.code&&20010==t.data.code){g.value=a.data.menuListTree;let e=[];t.data.role.menuList.forEach((a=>{e.push(a.id)})),m.value.setCheckedKeys(e),i.value=t.data.role}else(0,r.z8)({message:a.data.msg,type:"error"}),(0,r.z8)({message:t.data.msg,type:"error"});console.log("从后台填充...")}catch(a){console.log("e=",a)}},h=e=>{n.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},y=()=>{d.value=!1},k=async()=>{let e,t;console.log("提交权限分配..."),e="/api/sys/roles/grantMenu/"+i.value.id;try{t=await s.ZP.put(e,m.value.getCheckedKeys()),console.log("分配给角色权限菜单 res.data= ",t.data),20030==t.data.code?((0,r.z8)({message:t.data.msg,type:"success"}),a("handleSubmit"),y()):(0,r.z8)({message:t.data.msg,type:"error"})}catch(l){console.log("e=",l),(0,r.z8)({message:"操作失败！"+l,type:"error"})}};return(0,l.YP)(d,(e=>{1==e&&f(t.id)})),(a,t)=>{const s=(0,l.up)("el-tree"),r=(0,l.up)("el-form-item"),n=(0,l.up)("el-form"),b=(0,l.up)("el-button"),w=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(w,{modelValue:(0,o.SU)(d),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.dq)(d)?d.value=e:null),title:"分配权限","before-close":h,width:"30%",draggable:""},{footer:(0,l.w5)((()=>[(0,l._)("span",u,[(0,l.Wm)(b,{onClick:t[0]||(t[0]=a=>f(e.id))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{onClick:y},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:k},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(n,{model:i.value},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,{props:c,data:g.value,ref_key:"treeRef",ref:m,"node-key":"id","show-checkbox":"","default-expand-all":"","check-strictly":"",onCheckChange:p},null,8,["data"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])}}});const c=i;var g=c}}]);
//# sourceMappingURL=722.6595ba91.js.map
"use strict";(self["webpackChunkhosp"]=self["webpackChunkhosp"]||[]).push([[915,708],{7708:function(e,l,a){a.r(l),a.d(l,{default:function(){return c}});a(7658);var t=a(3396),o=a(4870),i=a(4901),d=a(7178),r=a(2655);const n={class:"dialog-footer"},u={name:"EditDialog"};var s=Object.assign(u,{props:{editDialogVisible:{type:Boolean,required:!0,default:!1},id:{type:Number,required:!0,default:-1},title:{type:String,required:!0,default:""}},emits:["update:editDialogVisible","handleSubmit"],setup(e,{emit:l}){const a=e,u=(0,t.Fl)({get(){return a.editDialogVisible},set(e){l("update:editDialogVisible",e)}}),s=(0,o.iH)({id:-1,parentId:0,type:"",name:"",sequence:1,icon:"",perms:"",component:"",path:"",disabled:!1,note:""}),m=(0,o.iH)([]),c=["Plus","Minus","CirclePlus","Search","Female","Male","Aim","House","FullScreen","Loading","Link","Service","Pointer","Star","Notification","Connection","ChatDotRound","Setting","Clock","Position","Discount","Odometer","ChatSquare","ChatRound","ChatLineRound","ChatLineSquare","ChatDotSquare","View","Hide","Unlock","Lock","RefreshRight","RefreshLeft","Refresh","Bell","MuteNotification","User","Check","CircleCheck","Warning","CircleClose","Close","PieChart","More","Compass","Filter","Switch","Select","SemiSelect","CloseBold","EditPen","Edit","Message","MessageBox","TurnOff","Finished","Delete","Crop","SwitchButton","Operation","Open","Remove","ZoomOut","ZoomIn","InfoFilled","CircleCheckFilled","SuccessFilled","WarningFilled","CircleCloseFilled","QuestionFilled","WarnTriangleFilled","UserFilled","MoreFilled","Tools","HomeFilled","Menu","UploadFilled","Avatar","HelpFilled","Share","StarFilled","Comment","Histogram","Grid","Promotion","DeleteFilled","RemoveFilled","CirclePlusFilled","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","ArrowLeftBold","ArrowUpBold","ArrowRightBold","ArrowDownBold","DArrowRight","DArrowLeft","Download","Upload","Top","Bottom","Back","Right","TopRight","TopLeft","BottomRight","BottomLeft","Sort","SortUp","SortDown","Rank","CaretLeft","CaretTop","CaretRight","CaretBottom","DCaret","Expand","Fold","DocumentAdd","Document","Notebook","Tickets","Memo","Collection","Postcard","ScaleToOriginal","SetUp","DocumentDelete","DocumentChecked","DataBoard","DataAnalysis","CopyDocument","FolderChecked","Files","Folder","FolderDelete","FolderRemove","FolderOpened","DocumentCopy","DocumentRemove","FolderAdd","FirstAidKit","Reading","DataLine","Management","Checked","Ticket","Failed","TrendCharts","List","Microphone","Mute","Mic","VideoPause","VideoCamera","VideoPlay","Headset","Monitor","Film","Camera","Picture","PictureRounded","Iphone","Cellphone","VideoCameraFilled","PictureFilled","Platform","CameraFilled","BellFilled","Location","LocationInformation","DeleteLocation","Coordinate","Bicycle","OfficeBuilding","School","Guide","AddLocation","MapLocation","Place","LocationFilled","Van","Watermelon","Pear","NoSmoking","Smoking","Mug","GobletSquareFull","GobletFull","KnifeFork","Sugar","Bowl","MilkTea","Lollipop","Coffee","Chicken","Dish","IceTea","ColdDrink","CoffeeCup","DishDot","IceDrink","IceCream","Dessert","IceCreamSquare","ForkSpoon","IceCreamRound","Food","HotWater","Grape","Fries","Apple","Burger","Goblet","GobletSquare","Orange","Cherry","Printer","Calendar","CreditCard","Box","Money","Refrigerator","Cpu","Football","Brush","Suitcase","SuitcaseLine","Umbrella","AlarmClock","Medal","GoldMedal","Present","Mouse","Watch","QuartzWatch","Magnet","Help","Soccer","ToiletPaper","ReadingLamp","Paperclip","MagicStick","Basketball","Baseball","Coin","Goods","Sell","SoldOut","Key","ShoppingCart","ShoppingCartFull","ShoppingTrolley","Phone","Scissor","Handbag","ShoppingBag","Trophy","TrophyBase","Stopwatch","Timer","CollectionTag","TakeawayBox","PriceTag","Wallet","Opportunity","PhoneFilled","WalletFilled","GoodsFilled","Flag","BrushFilled","Briefcase","Stamp","Sunrise","Sunny","Ship","MostlyCloudy","PartlyCloudy","Sunset","Drizzling","Pouring","Cloudy","Moon","MoonNight","Lightning","ChromeFilled","Eleme","ElemeFilled","ElementPlus","Shop","SwitchFilled","WindPower"],p=(0,o.iH)(!1),g=(0,o.iH)(!1),h=(0,o.iH)(!1),w=(0,o.iH)(!1),f=async(e,l,a)=>{let t;if("name"==e.field?l&&l.length>16?a(new Error("菜单名称长度不可超过16位")):t="/api/sys/menus/checkMenu?id="+s.value.id+"&name="+l:"perms"==e.field?l&&l.length>32?a(new Error("权限代码长度不可超过32位")):t="/api/sys/menus/checkMenu?id="+s.value.id+"&perms="+l:"parentId"==e.field?-1==l?a(new Error("上级菜单不能为空")):a():"icon"==e.field?l&&l.length>32?a(new Error("图标长度不可超过32位")):a():"component"==e.field?l&&l.length>128?a(new Error("组件路径长度不可超过128位")):a():"path"==e.field&&(l&&l.length>128?a(new Error("路由路径长度不可超过128位")):a()),t){let e=await i.ZP.post(t);1==e.data.code?a(new Error(e.data.msg)):a()}},b=(0,o.qj)({name:[{required:!0,message:"菜单名称不能为空",trigger:"blur"},{validator:f,trigger:"change"},{validator:f,trigger:"blur"}],parentId:[{required:!0,message:"上级菜单不能为空",trigger:"blur"}],type:[{required:!0,message:"类型不能为空",trigger:"blur"}],sequence:[{required:!0,message:"序号不能为空",trigger:"blur"}],icon:[{validator:f,trigger:"blur"}],perms:[{validator:f,trigger:"change"},{validator:f,trigger:"blur"}],component:[{required:!1,max:128,message:"组件路径长度不可超过128个字符",trigger:"blur"}],path:[{required:!1,max:128,message:"路由路径长度不可超过128个字符",trigger:"blur"}],disabled:[{required:!0,message:"状态不能为空",trigger:"blur"}],note:[{required:!1,max:192,message:"备注信息不可超过192个字符",trigger:"blur"}]}),v=(0,o.iH)(null),y=async e=>{if(-1==e)s.value={id:-1,parentId:0,type:"",name:"",sequence:1,icon:"",perms:"",component:"",path:"",disabled:!1,note:""},console.log("清空表单...");else{let l=await i.ZP.get("/api/sys/menus/"+e);if(console.log(l.data),20010==l.data.code){let e=l.data.menu;s.value=e}else(0,d.z8)({message:l.data.msg,type:"error"});console.log("从后台填充...")}let l=await i.ZP.get("/api/sys/menus");if(console.log(l.data),20010==l.data.code){let e=[];l.data.menuListTree.forEach((l=>{"F"!=l.type&&"M"!=l.type||(l.name="+ "+l.name,e.push(l),l.children.forEach((l=>{"M"==l.type&&(l.name="••• "+l.name,e.push(l))})))})),m.value=e}else(0,d.z8)({message:l.data.msg,type:"error"})},C=e=>{r.T.confirm("确认在未保存的情况下关闭对话框？").then((()=>{e()})).catch((()=>{}))},S=()=>{u.value=!1},k=()=>{v.value.validate((async e=>{if(e){let e,a;-1==s.value.id?(console.log("提交新增..."),e="/api/sys/menus",a=await i.ZP.post(e,s.value),console.log("新增菜单 res.data= ",a.data)):(console.log("提交修改..."),e="/api/sys/menus",a=await i.ZP.put(e,s.value),console.log("修改菜单 res.data= ",a.data)),20020==a.data.code||20030==a.data.code?((0,d.z8)({message:a.data.msg,type:"success"}),l("handleSubmit"),S()):(0,d.z8)({message:a.data.msg,type:"error"})}}))};return(0,t.YP)(u,(e=>{1==e&&y(a.id)})),(0,t.YP)(s,(e=>{"F"==e.type?(p.value=!1,g.value=!0,h.value=!0,w.value=!1):"M"==e.type?(p.value=!1,g.value=!0,h.value=!1,w.value=!1):"P"==e.type&&(p.value=!0,g.value=!1,h.value=!0,w.value=!0)}),{deep:!0}),(l,a)=>{const i=(0,t.up)("el-radio"),d=(0,t.up)("el-radio-group"),r=(0,t.up)("el-form-item"),f=(0,t.up)("el-option"),W=(0,t.up)("el-select"),F=(0,t.up)("el-switch"),V=(0,t.up)("el-input"),D=(0,t.up)("el-input-number"),P=(0,t.up)("el-form"),U=(0,t.up)("el-button"),_=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.j4)(_,{modelValue:(0,o.SU)(u),"onUpdate:modelValue":a[11]||(a[11]=e=>(0,o.dq)(u)?u.value=e:null),title:e.title,"before-close":C,width:"600px",draggable:""},{footer:(0,t.w5)((()=>[(0,t._)("span",n,[(0,t.Wm)(U,{onClick:a[10]||(a[10]=l=>y(e.id))},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1}),(0,t.Wm)(U,{onClick:S},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(U,{type:"primary",onClick:k},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(P,{ref_key:"editFormRef",ref:v,model:s.value,rules:b,inline:"","label-width":"80px","label-position":"right","status-icon":""},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"类型",prop:"type",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:s.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.type=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{label:"F"},{default:(0,t.w5)((()=>[(0,t.Uk)("目录")])),_:1}),(0,t.Wm)(i,{label:"M"},{default:(0,t.w5)((()=>[(0,t.Uk)("菜单")])),_:1}),(0,t.Wm)(i,{label:"P"},{default:(0,t.w5)((()=>[(0,t.Uk)("权限")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"父节点",prop:"parentId",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:s.value.parentId,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.parentId=e),placeholder:"请选择上级菜单"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{label:"顶级菜单",value:0}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(m.value,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"状态",prop:"disabled",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{modelValue:s.value.disabled,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.disabled=e),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"启用","inactive-text":"禁用","active-value":!1,"inactive-value":!0,width:"50px"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"名称",prop:"name",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:s.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"图标",prop:"icon",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:s.value.icon,"onUpdate:modelValue":a[4]||(a[4]=e=>s.value.icon=e),filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,"suffix-icon":s.value.icon,disabled:p.value},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(c,(e=>(0,t.Wm)(f,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue","suffix-icon","disabled"])])),_:1}),(0,t.Wm)(r,{label:"组件路径",prop:"component",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:s.value.component,"onUpdate:modelValue":a[5]||(a[5]=e=>s.value.component=e),disabled:h.value},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(r,{label:"路由路径",prop:"path",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:s.value.path,"onUpdate:modelValue":a[6]||(a[6]=e=>s.value.path=e),disabled:w.value},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(r,{label:"权限代码",prop:"perms",style:{width:"48%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:s.value.perms,"onUpdate:modelValue":a[7]||(a[7]=e=>s.value.perms=e),disabled:g.value},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(r,{label:"相对顺序",prop:"sequence",style:{width:"40%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{modelValue:s.value.sequence,"onUpdate:modelValue":a[8]||(a[8]=e=>s.value.sequence=e),min:1,max:10},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"备注",prop:"note",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:s.value.note,"onUpdate:modelValue":a[9]||(a[9]=e=>s.value.note=e),type:"textarea",rows:5},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}});const m=s;var c=m},2915:function(e,l,a){a.r(l),a.d(l,{default:function(){return p}});var t=a(3396),o=a(4870),i=a(2748),d=a(4901),r=a(7708),n=a(7178);const u={name:"index"};var s=Object.assign(u,{setup(e){const l=(0,o.iH)(400),a=(0,o.iH)([]),u=(0,o.iH)(!1),s=(0,o.iH)(-1),m=(0,o.iH)(""),c=async e=>{console.log("删除...",e);let l="/api/sys/menus/"+e;console.log("url=",l);let a=await d.ZP.del(l);console.log("res=",a),20040==a.data.code?((0,n.z8)({message:a.data.msg,type:"success"}),await h()):(0,n.z8)({message:a.data.msg,type:"error"})},p=e=>{e?(console.log("修改...",e),s.value=e,m.value="权限修改"):(console.log("新增...",e),s.value=-1,m.value="权限添加"),u.value=!0},g=async e=>{e.loading=!0;let l="/api/sys/menus/updateDisabled/"+e.id+"/"+e.disabled;try{let a=await d.ZP.put(l);20030==a.data.code?(0,n.z8)({message:a.data.msg,type:"success"}):((0,n.z8)({message:a.data.msg,type:"error"}),e.disabled=!e.disabled)}catch(a){console.log("e=",a),(0,n.z8)({message:"操作失败！"+a,type:"error"}),e.disabled=!e.disabled}e.loading=!1},h=async()=>{let e="/api/sys/menus";console.log("url=",e);let l=await d.ZP.get(e);if(console.log("更新菜单列表 res= ",l),20010==l.data.code){let e=l.data.menuListTree;a.value=e}else(0,n.z8)({message:l.data.msg,type:"error"})};h();const w=new ResizeObserver((e=>{for(const a of e)if("mainView"==a.target.id){let e;if(a.contentBoxSize){const l=Array.isArray(a.contentBoxSize)?a.contentBoxSize[0]:a.contentBoxSize;e=l.blockSize}else e=a.contentRect.height;l.value=e}}));return(0,t.bv)((()=>{const e=document.getElementById("mainView");w.observe(e)})),(e,d)=>{const n=(0,t.up)("el-button"),w=(0,t.up)("el-row"),f=(0,t.up)("el-header"),b=(0,t.up)("el-table-column"),v=(0,t.up)("el-icon"),y=(0,t.up)("el-switch"),C=(0,t.up)("el-popconfirm"),S=(0,t.up)("el-table"),k=(0,t.up)("el-main"),W=(0,t.up)("el-container");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"operatingFloor"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{gutter:20},{default:(0,t.w5)((()=>[e.hasAnyAuthority("system:menu:add")?((0,t.wg)(),(0,t.j4)(n,{key:0,type:"success",icon:(0,o.SU)(i.DocumentAdd),onClick:d[0]||(d[0]=e=>p(null)),style:{"margin-left":"12px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["icon"])):(0,t.kq)("",!0)])),_:1})])),_:1}),(0,t.Wm)(k,{style:{padding:"5px",background:"aliceblue"},id:"mainView"},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{data:a.value,"max-height":l.value,"row-key":"id",indent:25,size:"small",style:{width:"100%"},"highlight-current-row":"","default-expand-all":"",stripe:""},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{prop:"name",label:"权限名称",width:"160","header-align":"center",fixed:""}),(0,t.Wm)(b,{prop:"icon",label:"图标",width:"55",align:"center"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(v,{size:20},{default:(0,t.w5)((()=>[""!=e.icon?((0,t.wg)(),(0,t.j4)((0,t.LL)(e.icon),{key:0})):(0,t.kq)("",!0)])),_:2},1024)])),_:1}),(0,t.Wm)(b,{prop:"sequence",label:"序号",width:"55",align:"center"}),(0,t.Wm)(b,{prop:"perms",label:"权限代码",width:"180","header-align":"center"}),(0,t.Wm)(b,{prop:"component",label:"组件路径",width:"150","header-align":"center"}),(0,t.Wm)(b,{prop:"path",label:"路由路径",width:"120","header-align":"center"}),(0,t.Wm)(b,{prop:"disabled",label:"状态",width:"76",align:"center"},{default:(0,t.w5)((({row:l})=>[(0,t.Wm)(y,{modelValue:l.disabled,"onUpdate:modelValue":e=>l.disabled=e,"inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"启用","inactive-text":"禁用","active-value":!1,"inactive-value":!0,width:"50px",loading:l.loading,onChange:e=>g(l),disabled:!e.hasAnyAuthority("system:menu:edit")},null,8,["modelValue","onUpdate:modelValue","loading","onChange","disabled"])])),_:1}),(0,t.Wm)(b,{prop:"createTime",label:"创建时间",width:"160","header-align":"center"}),(0,t.Wm)(b,{prop:"updateTime",label:"更新时间",width:"160","header-align":"center"}),(0,t.Wm)(b,{prop:"note",label:"备注","min-width":"150","header-align":"center"}),(0,t.Wm)(b,{label:"操作",width:"130",align:"right","header-align":"center",fixed:"right"},{default:(0,t.w5)((l=>[e.hasAnyAuthority("system:menu:edit")?((0,t.wg)(),(0,t.j4)(n,{key:0,type:"primary",icon:(0,o.SU)(i.Edit),onClick:e=>p(l.row.id)},null,8,["icon","onClick"])):(0,t.kq)("",!0),e.hasAnyAuthority("system:menu:delete")?((0,t.wg)(),(0,t.j4)(C,{key:1,title:"您确定要删除这条记录吗？",onConfirm:e=>c(l.row.id)},{reference:(0,t.w5)((()=>[(0,t.Wm)(n,{type:"danger",icon:(0,o.SU)(i.Delete)},null,8,["icon"])])),_:2},1032,["onConfirm"])):(0,t.kq)("",!0)])),_:1})])),_:1},8,["data","max-height"])])),_:1})])),_:1}),(0,t.Wm)((0,o.SU)(r["default"]),{"edit-dialog-visible":u.value,"onUpdate:edit-dialog-visible":d[1]||(d[1]=e=>u.value=e),id:s.value,title:m.value,onHandleSubmit:h},null,8,["edit-dialog-visible","id","title"])],64)}}}),m=a(89);const c=(0,m.Z)(s,[["__scopeId","data-v-3c7c89c3"]]);var p=c}}]);
//# sourceMappingURL=915.12499dec.js.map